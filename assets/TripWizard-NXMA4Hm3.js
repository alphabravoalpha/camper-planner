import{c as S,r as Q,b as G,i as k,d as A,u as V,M as E,R as Z,e as X,j as e,X as J,E as q,m as W}from"./index-D1Y6GeN0.js";import{a as j,R as ee}from"./react-vendor-BKsxK57A.js";import{i as te,n as H,g as se,C as O,S as _,a as ae,b as F}from"./PlannerPage-DG8VqSn6.js";import{C as re,T as L}from"./triangle-alert-DYw3rxgl.js";import{C as ne}from"./chevron-left-DlIbCoo7.js";import{C as K}from"./chevron-right-HgxmtkrK.js";import{C as ie}from"./clock-BYBCM7c-.js";import{L as le}from"./lightbulb-C_ZzYb7y.js";import"./state-vendor-E9RzGJqF.js";import"./map-vendor-F4U-KZbU.js";import"./file-text-B1TCAAzH.js";import"./trash-2-DPIXIfZS.js";import"./zap-CC5TY6jT.js";import"./fuel-DK8y6WAN.js";import"./star-DGZJB3U0.js";import"./download-BeIngjKG.js";import"./globe-CJS6Z_d8.js";import"./chevron-down-D-83emCf.js";const oe=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],ce=S("arrow-left-right",oe);const de=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],T=S("check",de);const me=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],he=S("cloud-rain",me);const ue=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],pe=S("leaf",ue);const xe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],z=S("loader-circle",xe);const ge=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],ye=S("rocket",ge);const fe=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],be=S("snowflake",fe);const ve=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],B=S("sun",ve);const je=[["path",{d:"M8 3.1V7a4 4 0 0 0 8 0V3.1",key:"1v71zp"}],["path",{d:"m9 15-1-1",key:"1yrq24"}],["path",{d:"m15 15 1-1",key:"1t0d6s"}],["path",{d:"M9 19c-2.8 0-5-2.2-5-5v-4a8 8 0 0 1 16 0v4c0 2.8-2.2 5-5 5Z",key:"1p0hjs"}],["path",{d:"m8 19-2 3",key:"13i0xs"}],["path",{d:"m16 19 2 3",key:"xo31yx"}]],Ne=S("train-front",je),U={relaxed:{maxDailyHours:4,maxDailyDistance:250,description:"Take it easy. Short drives with plenty of time to explore, arrive early and enjoy your campsite.",shortDescription:"~4 hours / ~250 km per day"},moderate:{maxDailyHours:6,maxDailyDistance:350,description:"A good balance. Enough driving to make progress, with time to stop and explore along the way.",shortDescription:"~6 hours / ~350 km per day"},intensive:{maxDailyHours:8,maxDailyDistance:450,description:"Cover ground efficiently. Longer driving days for experienced road-trippers who want to reach their destination faster.",shortDescription:"~8 hours / ~450 km per day"}};function R(s,t,a,o){const i=(a-s)*Math.PI/180,l=(o-t)*Math.PI/180,r=Math.sin(i/2)**2+Math.cos(s*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(l/2)**2;return 6371*2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))}async function we(s,t){try{const a=`https://nominatim.openstreetmap.org/reverse?lat=${s}&lon=${t}&format=json&zoom=10&accept-language=en`,o=await fetch(a,{headers:{"User-Agent":"EuropeanCamperPlanner/1.0"}});if(!o.ok)return`${s.toFixed(2)}°N, ${t.toFixed(2)}°E`;const n=await o.json(),i=n.address;if(i){const l=i.city||i.town||i.village||i.hamlet||"",r=i.state||i.county||"",c=i.country||"";if(l&&c)return`${l}, ${c}`;if(r&&c)return`${r}, ${c}`;if(c)return c}return n.display_name?.split(",").slice(0,2).join(",").trim()||`${s.toFixed(2)}°N, ${t.toFixed(2)}°E`}catch{return`${s.toFixed(2)}°N, ${t.toFixed(2)}°E`}}class Y{static async generateItinerary(t){const a=U[t.drivingStyle],o=[],n=this.buildRouteWaypoints(t),i=await Q.calculateRoute({waypoints:n,vehicleProfile:t.vehicleProfile,options:{geometry:!0,instructions:!0}});if(i.status==="error"||i.routes.length===0)throw new Error(i.errors?.join(", ")||"Failed to calculate route");const l=i.routes[0],r=l.geometry.coordinates,c=l.summary.distance/1e3,u=l.summary.duration/3600,d=this.splitRouteIntoDays(r,a.maxDailyDistance,c),m=[],p=r[0];m.push({lat:p[1],lng:p[0],name:t.start.name,distanceFromStart:0});for(let b=0;b<d.length;b++){const v=d[b];b>0&&await this.delay(1100);const f=await we(v.lat,v.lng);m.push({...v,name:f})}const y=r[r.length-1];m.push({lat:y[1],lng:y[0],name:t.end.name,distanceFromStart:c});const x=[];let g=1,w=new Date(t.startDate),D=0,M=!1;for(let b=0;b<m.length-1;b++){const v=m[b],f=m[b+1],$=f.distanceFromStart-v.distanceFromStart,P=$*(u/c),h=!M&&!!(t.crossing&&this.isPointNearCrossing(v,f,t.crossing));h&&(M=!0);let N=[];const C=b===m.length-2;C||(N=await this.findCampsitesNearPoint(f.lat,f.lng,t.vehicleProfile));const I={dayNumber:g,date:new Date(w),type:h?"crossing":"driving",start:{name:v.name,lat:v.lat,lng:v.lng},end:{name:f.name,lat:f.lat,lng:f.lng},distance:Math.round($),drivingTime:Math.round(P*10)/10,overnightOptions:N,selectedOvernight:N[0]||void 0,crossing:h?t.crossing:void 0,notes:this.generateDayNotes($,P,a,h,C)};x.push(I),g++,w=new Date(w.getTime()+1440*60*1e3),D++,t.restDayFrequency>0&&D>=t.restDayFrequency&&!C&&(x.push({dayNumber:g,date:new Date(w),type:"rest",start:{name:f.name,lat:f.lat,lng:f.lng},end:{name:f.name,lat:f.lat,lng:f.lng},distance:0,drivingTime:0,overnightOptions:I.overnightOptions,selectedOvernight:I.selectedOvernight,notes:["Rest day — explore the area, relax, or do laundry!"]}),g++,w=new Date(w.getTime()+1440*60*1e3),D=0)}return c>2500&&o.push("This is a long trip. Consider adding rest days for comfort."),t.crossing?.overnightCrossing&&o.push(`The ${t.crossing.name} is an overnight crossing — you'll sleep on the ferry.`),{days:x,crossing:t.crossing,totalDistance:Math.round(c),totalDrivingTime:Math.round(u*10)/10,totalDays:x.length,routeGeometry:r.map(([b,v])=>[v,b]),warnings:o}}static buildRouteWaypoints(t){const a=[],o=te(t.start.lat,t.start.lng);return a.push({id:"wizard-start",lat:t.start.lat,lng:t.start.lng,type:"start",name:t.start.name}),t.crossing&&(o?(a.push({id:"wizard-crossing-depart",lat:t.crossing.departure.lat,lng:t.crossing.departure.lng,type:"waypoint",name:`${t.crossing.departure.name} (${t.crossing.type==="tunnel"?"Tunnel":"Ferry"} Terminal)`}),a.push({id:"wizard-crossing-arrive",lat:t.crossing.arrival.lat,lng:t.crossing.arrival.lng,type:"waypoint",name:`${t.crossing.arrival.name} (Arrival)`})):(a.push({id:"wizard-crossing-depart",lat:t.crossing.arrival.lat,lng:t.crossing.arrival.lng,type:"waypoint",name:`${t.crossing.arrival.name} (${t.crossing.type==="tunnel"?"Tunnel":"Ferry"} Terminal)`}),a.push({id:"wizard-crossing-arrive",lat:t.crossing.departure.lat,lng:t.crossing.departure.lng,type:"waypoint",name:`${t.crossing.departure.name} (Arrival)`}))),a.push({id:"wizard-end",lat:t.end.lat,lng:t.end.lng,type:"end",name:t.end.name}),a}static splitRouteIntoDays(t,a,o){const n=[];if(t.length<2)return n;let i=0,l=0;for(let r=1;r<t.length;r++){const c=t[r-1][0],u=t[r-1][1],d=t[r][0],m=t[r][1],p=R(u,c,m,d);i+=p,l+=p,l>=a&&o-i>a*.3&&(n.push({lat:m,lng:d,distanceFromStart:i}),l=0)}return n}static async findCampsitesNearPoint(t,a,o){const i=.009009009009009009,l={south:t-15*i,north:t+15*i,west:a-15*i/Math.cos(t*Math.PI/180),east:a+15*i/Math.cos(t*Math.PI/180)};try{const r=await G.searchCampsites({bounds:l,types:["campsite","caravan_site"],maxResults:20});return!r.campsites||r.campsites.length===0?[]:r.campsites.map(u=>{const d=R(t,a,u.lat,u.lng),m=this.getAmenityList(u),p=this.scoreCampsite(u,d,o);return{campsite:u,distanceFromRoute:Math.round(d*10)/10,suitabilityScore:p,amenitySummary:m}}).filter(u=>u.distanceFromRoute<=15).sort((u,d)=>d.suitabilityScore-u.suitabilityScore).slice(0,3)}catch(r){return console.error("Failed to find campsites near point:",r),[]}}static scoreCampsite(t,a,o){let n=50;return t.amenities.showers&&(n+=10),t.amenities.electricity&&(n+=10),t.amenities.toilets&&(n+=8),t.amenities.drinking_water&&(n+=5),t.amenities.wifi&&(n+=5),t.amenities.restaurant&&(n+=3),t.amenities.laundry&&(n+=3),t.amenities.swimming_pool&&(n+=2),t.amenities.playground&&(n+=2),t.amenities.shop&&(n+=2),t.name&&!t.name.startsWith("campsite ")&&(n+=5),a<2?n+=10:a<5?n+=5:a>10&&(n-=10),t.type==="campsite"?n+=5:t.type==="caravan_site"&&(n+=3),Math.min(100,Math.max(0,n))}static getAmenityList(t){const a=[];return t.amenities.showers&&a.push("Showers"),t.amenities.electricity&&a.push("Electric"),t.amenities.toilets&&a.push("Toilets"),t.amenities.drinking_water&&a.push("Water"),t.amenities.wifi&&a.push("WiFi"),t.amenities.restaurant&&a.push("Restaurant"),t.amenities.laundry&&a.push("Laundry"),t.amenities.swimming_pool&&a.push("Pool"),t.amenities.shop&&a.push("Shop"),t.amenities.playground&&a.push("Playground"),a}static generateDayNotes(t,a,o,n,i){const l=[];if(n&&l.push("This day includes a channel crossing — allow extra time for check-in and boarding."),i&&l.push("Arrival day! You've made it to your destination."),a>o.maxDailyHours*.9&&l.push("Long driving day — make sure to take regular breaks."),a<2&&!i&&l.push("Short driving day — plenty of time to explore the area."),t>200){const r=Math.floor(a/2);r>0&&l.push(`Plan for ${r} rest stop${r>1?"s":""} during the drive.`)}return l}static isPointNearCrossing(t,a,o){const n=R(t.lat,t.lng,o.departure.lat,o.departure.lng)<50||R(a.lat,a.lng,o.departure.lat,o.departure.lng)<50,i=R(t.lat,t.lng,o.arrival.lat,o.arrival.lng)<50||R(a.lat,a.lng,o.arrival.lat,o.arrival.lng)<50;return n||i}static needsCrossing(t,a,o,n){return H(t,a,o,n)}static getRecommendedCrossings(t,a,o,n){return se(t,a,o,n)}static delay(t){return new Promise(a=>setTimeout(a,t))}}const Se=[{id:"start-end",label:"Route",icon:E},{id:"dates",label:"Dates",icon:re},{id:"driving",label:"Driving",icon:O},{id:"crossing",label:"Crossing",icon:_},{id:"itinerary",label:"Itinerary",icon:Z}],Qe=()=>{const s=k(),{profile:t}=A(),a=V(),o=s.start&&s.end?H(s.start.lat,s.start.lng,s.end.lat,s.end.lng):!1,n=Se.filter(m=>m.id!=="crossing"||o),i=n[s.wizardStep]?.id||"start-end",l=s.wizardStep===n.length-1,r=s.wizardStep===0,c=(()=>{switch(i){case"start-end":return!!(s.start&&s.end);case"dates":return!!s.startDate;case"driving":return!0;case"crossing":return o?!!s.crossing:!0;case"itinerary":return!!s.itinerary;default:return!1}})(),u=j.useCallback(async()=>{if(l)return;const m=s.wizardStep+1;if(n[m]?.id==="itinerary"&&s.start&&s.end&&s.startDate){s.setStep(m),s.setIsGenerating(!0),s.setGenerationError(null);try{const y=await Y.generateItinerary({start:s.start,end:s.end,startDate:s.startDate,endDate:s.endDate||void 0,drivingStyle:s.drivingStyle,crossing:s.crossing||void 0,restDayFrequency:s.restDayFrequency,vehicleProfile:t||void 0});s.setItinerary(y)}catch(y){s.setGenerationError(y.message||"Failed to generate itinerary")}finally{s.setIsGenerating(!1)}}else s.setStep(m)},[s,n,l,t]),d=j.useCallback(()=>{if(!s.itinerary)return;a.clearRoute();const m=[];s.itinerary.days.forEach((x,g)=>{g===0&&m.push({id:`trip-${Date.now()}-start`,lat:x.start.lat,lng:x.start.lng,type:"start",name:x.start.name}),x.selectedOvernight&&g<s.itinerary.days.length-1&&m.push({id:`trip-${Date.now()}-camp-${g}`,lat:x.selectedOvernight.campsite.lat,lng:x.selectedOvernight.campsite.lng,type:"campsite",name:x.selectedOvernight.campsite.name}),g===s.itinerary.days.length-1&&m.push({id:`trip-${Date.now()}-end`,lat:x.end.lat,lng:x.end.lng,type:"end",name:x.end.name})}),m.forEach(x=>a.addWaypoint(x));const p=s.crossing,y=p?p.type==="tunnel"?"eurotunnel":"ferry":void 0;X.getState().updateSettings({...s.startDate?{startDate:s.startDate.toISOString().split("T")[0]}:{},...s.endDate?{endDate:s.endDate.toISOString().split("T")[0]}:{},drivingStyle:s.drivingStyle,restDayFrequency:s.restDayFrequency,...p&&y?{crossing:{type:y,estimatedCost:Math.round((p.estimatedCost.low+p.estimatedCost.high)/2)}}:{}}),s.closeWizard(),s.resetWizard()},[s,a]);return s.wizardOpen?e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/40 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl ring-1 ring-black/5 w-full max-w-3xl max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-neutral-100",children:[e.jsx("h2",{className:"text-xl font-display font-bold text-neutral-900",children:"Plan Your Trip"}),e.jsx("button",{onClick:()=>{s.closeWizard(),s.resetWizard()},className:"p-2 hover:bg-neutral-100 rounded-lg transition-all duration-200",children:e.jsx(J,{className:"w-5 h-5 text-neutral-500"})})]}),e.jsx("div",{className:"px-6 py-3 border-b border-neutral-100",children:e.jsx("div",{className:"flex items-center gap-2",children:n.map((m,p)=>{const y=m.icon,x=p===s.wizardStep,g=p<s.wizardStep;return e.jsxs(ee.Fragment,{children:[p>0&&e.jsx("div",{className:`flex-1 h-0.5 ${g?"bg-primary-500":"bg-neutral-200"}`}),e.jsxs("button",{onClick:()=>p<s.wizardStep&&s.setStep(p),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-200 ${x?"bg-primary-100 text-primary-700 ring-2 ring-primary-200":g?"bg-primary-50 text-primary-600 hover:bg-primary-100 cursor-pointer":"text-neutral-400"}`,disabled:p>s.wizardStep,children:[g?e.jsx(T,{className:"w-4 h-4"}):e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:m.label})]})]},m.id)})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:[i==="start-end"&&e.jsx(ke,{}),i==="dates"&&e.jsx(Ce,{}),i==="driving"&&e.jsx(De,{}),i==="crossing"&&e.jsx(Me,{}),i==="itinerary"&&e.jsx(Re,{onCreateTrip:d})]}),i!=="itinerary"&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-neutral-100",children:[e.jsxs("button",{onClick:()=>s.prevStep(),disabled:r,className:"flex items-center gap-2 px-4 py-2 text-neutral-600 hover:text-neutral-800 disabled:opacity-30 disabled:cursor-not-allowed transition-all duration-200",children:[e.jsx(ne,{className:"w-4 h-4"}),"Back"]}),e.jsxs("button",{onClick:u,disabled:!c,className:"flex items-center gap-2 px-6 py-2.5 bg-accent-500 text-white rounded-lg hover:bg-accent-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-display font-semibold shadow-sm hover:shadow-medium active:scale-[0.97]",children:[n[s.wizardStep+1]?.id==="itinerary"?"Generate Itinerary":"Next",e.jsx(K,{className:"w-4 h-4"})]})]})]})}):null},ke=()=>{const{start:s,end:t,setStart:a,setEnd:o}=k(),[n,i]=j.useState(s?.name||""),[l,r]=j.useState(t?.name||""),[c,u]=j.useState([]),[d,m]=j.useState([]),[p,y]=j.useState(!1),[x,g]=j.useState(!1),[w,D]=j.useState(null),M=j.useRef(),b=j.useRef(),v=j.useCallback(async h=>{if(h.length<2)return[];try{D(null);const N=await G.geocodeLocationMultiple(h,5);return N.length===0?[]:N.map((C,I)=>({place_id:I,display_name:C.display_name,lat:String(C.lat),lon:String(C.lng)}))}catch{return D("Search temporarily unavailable. Please try again."),[]}},[]),f=j.useCallback(h=>{i(h),M.current&&clearTimeout(M.current),h.length>=2?M.current=setTimeout(async()=>{y(!0);const N=await v(h);u(N),y(!1)},500):u([])},[v]),$=j.useCallback(h=>{r(h),b.current&&clearTimeout(b.current),h.length>=2?b.current=setTimeout(async()=>{g(!0);const N=await v(h);m(N),g(!1)},500):m([])},[v]),P=j.useCallback(()=>{const h=s;a(t),o(h),i(t?.name||""),r(s?.name||"")},[s,t,a,o]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-display font-semibold text-neutral-900 mb-1",children:"Where are you going?"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Enter your start and end locations for the trip."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[e.jsx(E,{className:"w-4 h-4 inline mr-1 text-green-600"}),"Starting from"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:n,onChange:h=>f(h.target.value),placeholder:"e.g. Edinburgh, Scotland",className:"w-full px-4 py-3 border-2 border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-200 focus:border-primary-500 text-base"}),p&&e.jsx(z,{className:"absolute right-3 top-3.5 w-5 h-5 text-neutral-400 animate-spin"}),s&&e.jsx(T,{className:"absolute right-3 top-3.5 w-5 h-5 text-green-500"})]}),c.length>0&&!s&&e.jsx("div",{className:"mt-1 bg-white rounded-lg shadow-medium ring-1 ring-black/5 overflow-hidden",children:c.map(h=>e.jsx("button",{onClick:()=>{a({name:h.display_name.split(",").slice(0,2).join(",").trim(),lat:parseFloat(h.lat),lng:parseFloat(h.lon)}),i(h.display_name.split(",").slice(0,2).join(",").trim()),u([])},className:"w-full text-left px-4 py-2.5 hover:bg-primary-50 border-b border-neutral-100 last:border-b-0 text-sm",children:h.display_name},h.place_id))}),s&&e.jsx("button",{onClick:()=>{a(null),i("")},className:"text-xs text-primary-600 hover:text-primary-700 mt-1",children:"Change"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:P,className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",title:"Swap start and end",children:e.jsx(ce,{className:"w-5 h-5 text-neutral-400"})})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:[e.jsx(E,{className:"w-4 h-4 inline mr-1 text-red-500"}),"Going to"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:l,onChange:h=>$(h.target.value),placeholder:"e.g. Elba, Italy",className:"w-full px-4 py-3 border-2 border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-200 focus:border-primary-500 text-base"}),x&&e.jsx(z,{className:"absolute right-3 top-3.5 w-5 h-5 text-neutral-400 animate-spin"}),t&&e.jsx(T,{className:"absolute right-3 top-3.5 w-5 h-5 text-green-500"})]}),d.length>0&&!t&&e.jsx("div",{className:"mt-1 bg-white rounded-lg shadow-medium ring-1 ring-black/5 overflow-hidden",children:d.map(h=>e.jsx("button",{onClick:()=>{o({name:h.display_name.split(",").slice(0,2).join(",").trim(),lat:parseFloat(h.lat),lng:parseFloat(h.lon)}),r(h.display_name.split(",").slice(0,2).join(",").trim()),m([])},className:"w-full text-left px-4 py-2.5 hover:bg-primary-50 border-b border-neutral-100 last:border-b-0 text-sm",children:h.display_name},h.place_id))}),t&&e.jsx("button",{onClick:()=>{o(null),r("")},className:"text-xs text-primary-600 hover:text-primary-700 mt-1",children:"Change"})]}),w&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700",children:[e.jsx(L,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:w})]})]}),s&&t&&e.jsxs("div",{className:"bg-primary-50 rounded-xl p-4 text-sm text-primary-800",children:[e.jsx("strong",{children:s.name})," → ",e.jsx("strong",{children:t.name}),e.jsx("br",{}),e.jsxs("span",{className:"text-primary-600",children:["Approx. ",Math.round(6371*2*Math.atan2(Math.sqrt(Math.sin((t.lat-s.lat)*Math.PI/180/2)**2+Math.cos(s.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin((t.lng-s.lng)*Math.PI/180/2)**2),Math.sqrt(1-Math.sin((t.lat-s.lat)*Math.PI/180/2)**2-Math.cos(s.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin((t.lng-s.lng)*Math.PI/180/2)**2)))," km as the crow flies"]})]})]})},Ce=()=>{const{startDate:s,endDate:t,setStartDate:a,setEndDate:o}=k(),i=s?(l=>{const r=l.getMonth();return r>=2&&r<=4?{name:"Spring",icon:e.jsx(pe,{className:"w-5 h-5 text-green-500"}),tip:"Great time for southern Europe. Some mountain passes may still be closed."}:r>=5&&r<=7?{name:"Summer",icon:e.jsx(B,{className:"w-5 h-5 text-yellow-500"}),tip:"Peak season — book campsites early! Great weather but busy roads."}:r>=8&&r<=10?{name:"Autumn",icon:e.jsx(he,{className:"w-5 h-5 text-orange-500"}),tip:"Beautiful colours, fewer crowds. Watch for early darkness and rain."}:{name:"Winter",icon:e.jsx(be,{className:"w-5 h-5 text-blue-400"}),tip:"Many campsites closed. Mountain passes may require snow chains."}})(s):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-display font-semibold text-neutral-900 mb-1",children:"When are you going?"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Set your departure date. End date is optional."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-neutral-700 mb-1",children:"Departure Date"}),e.jsx("input",{type:"date",value:s?s.toISOString().split("T")[0]:"",onChange:l=>a(l.target.value?new Date(l.target.value+"T00:00:00"):null),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border-2 border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-200 focus:border-primary-500 text-base"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-neutral-700 mb-1",children:["Return Date ",e.jsx("span",{className:"text-neutral-400",children:"(optional)"})]}),e.jsx("input",{type:"date",value:t?t.toISOString().split("T")[0]:"",onChange:l=>o(l.target.value?new Date(l.target.value+"T00:00:00"):null),min:s?s.toISOString().split("T")[0]:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border-2 border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-200 focus:border-primary-500 text-base"})]})]}),i&&e.jsxs("div",{className:"flex items-start gap-3 bg-amber-50 rounded-lg p-4",children:[i.icon,e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-amber-900",children:[i.name," Trip"]}),e.jsx("p",{className:"text-sm text-amber-700 mt-0.5",children:i.tip})]})]})]})},De=()=>{const{drivingStyle:s,setDrivingStyle:t,restDayFrequency:a,setRestDayFrequency:o}=k(),{profile:n}=A(),i=[{id:"relaxed",icon:B,title:"Relaxed"},{id:"moderate",icon:ae,title:"Moderate"},{id:"intensive",icon:ye,title:"Intensive"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-display font-semibold text-neutral-900 mb-1",children:"How do you like to drive?"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Choose your daily driving preference. This determines how the trip is broken into daily stages."})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:i.map(l=>{const r=U[l.id],c=s===l.id;return e.jsxs("button",{onClick:()=>t(l.id),className:`text-left p-4 rounded-xl border-2 transition-all duration-200 ${c?"border-primary-500 bg-primary-50 ring-2 ring-primary-200":"border-neutral-200 hover:border-neutral-300 hover:bg-neutral-50"}`,children:[e.jsx("div",{className:"mb-2",children:e.jsx(l.icon,{className:"w-6 h-6"})}),e.jsx("h4",{className:"font-display font-semibold text-neutral-900",children:l.title}),e.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:r.shortDescription}),e.jsx("p",{className:"text-xs text-neutral-400 mt-2 leading-relaxed",children:r.description})]},l.id)})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-neutral-700 mb-2",children:"Rest Days"}),e.jsx("div",{className:"flex gap-2",children:[{value:0,label:"No rest days"},{value:3,label:"Every 3 days"},{value:5,label:"Every 5 days"}].map(l=>e.jsx("button",{onClick:()=>o(l.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${a===l.value?"bg-primary-100 text-primary-700 border-2 border-primary-300":"bg-neutral-100 text-neutral-600 border-2 border-transparent hover:bg-neutral-200"}`,children:l.label},l.value))})]}),n&&e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-3 text-sm text-neutral-600",children:[e.jsx(O,{className:"w-4 h-4 inline mr-1"}),"Your vehicle: ",e.jsx("strong",{children:n.name||n.type||"Custom"}),n.type==="motorhome"&&s==="intensive"&&e.jsx("span",{className:"text-amber-600 ml-2",children:"— Intensive may be tiring in a motorhome. Moderate is recommended."})]})]})},Me=()=>{const{start:s,end:t,crossing:a,setCrossing:o}=k(),n={short:F.filter(c=>c.region==="short"),western:F.filter(c=>c.region==="western"),northern:F.filter(c=>c.region==="northern")},l=(s&&t?Y.getRecommendedCrossings(s.lat,s.lng,t.lat,t.lng):[])[0]?.id,r={short:{title:"Short Crossings",desc:"Dover & Folkestone — quickest to cross"},western:{title:"Western Crossings",desc:"Portsmouth, Plymouth & Poole — arrive further south/west"},northern:{title:"Northern Crossings",desc:"Harwich, Hull & Newcastle — best for northern routes"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-display font-semibold text-neutral-900 mb-1",children:"Getting to Europe"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Choose how you want to cross the Channel. We'll route via the terminals."})]}),Object.entries(n).map(([c,u])=>e.jsxs("div",{children:[e.jsx("h4",{className:"font-display font-semibold text-neutral-800 mb-1",children:r[c].title}),e.jsx("p",{className:"text-xs text-neutral-500 mb-2",children:r[c].desc}),e.jsx("div",{className:"space-y-2",children:u.map(d=>{const m=a?.id===d.id,p=d.id===l;return e.jsxs("button",{onClick:()=>o(m?null:d),className:`w-full text-left p-3 rounded-xl border-2 transition-all duration-200 ${m?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300 hover:bg-neutral-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d.type==="tunnel"?e.jsx(O,{className:"w-4 h-4 text-neutral-500"}):e.jsx(_,{className:"w-4 h-4 text-primary-500"}),e.jsx("span",{className:"font-medium text-neutral-900",children:d.name}),p&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Recommended"})]}),m&&e.jsx(T,{className:"w-5 h-5 text-primary-500"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1.5 text-xs text-neutral-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3.5 h-3.5"}),d.duration<60?`${d.duration} min`:`${Math.floor(d.duration/60)}h ${d.duration%60>0?`${d.duration%60}m`:""}`]}),e.jsx("span",{children:d.operators.join(", ")}),e.jsxs("span",{children:["£",d.estimatedCost.low,"–£",d.estimatedCost.high]}),d.overnightCrossing&&e.jsx("span",{className:"text-purple-600",children:"Overnight"})]}),m&&d.notes&&e.jsx("p",{className:"text-xs text-neutral-500 mt-2",children:d.notes}),m&&e.jsx("div",{className:"flex gap-2 mt-2",children:d.bookingUrls.map((y,x)=>e.jsxs("a",{href:y,target:"_blank",rel:"noopener noreferrer",onClick:g=>g.stopPropagation(),className:"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 bg-primary-50 px-2 py-1 rounded-lg",children:["Book with ",d.operators[x]||d.operators[0],e.jsx(q,{className:"w-3 h-3"})]},x))})]},d.id)})})]},c))]})},Re=({onCreateTrip:s})=>{const{itinerary:t,isGenerating:a,generationError:o}=k();return a?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(z,{className:"w-10 h-10 text-primary-500 animate-spin mb-4"}),e.jsx("h3",{className:"text-lg font-display font-semibold text-neutral-900",children:"Generating your trip plan..."}),e.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"Calculating route, finding campsites, and building your itinerary."})]}):o?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(L,{className:"w-10 h-10 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-display font-semibold text-neutral-900",children:"Failed to generate itinerary"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:o}),e.jsx("button",{onClick:()=>k.getState().prevStep(),className:"mt-4 px-4 py-2 bg-neutral-100 text-neutral-700 rounded-lg hover:bg-neutral-200",children:"Go back and try again"})]}):t?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-display font-bold text-neutral-900",children:"Your Trip Itinerary"}),e.jsxs("p",{className:"text-sm text-neutral-500",children:[t.totalDays," days · ",t.totalDistance," km · ",t.totalDrivingTime," hours driving"]})]})}),t.warnings.length>0&&e.jsx("div",{className:"bg-amber-50 rounded-lg p-3 space-y-1",children:t.warnings.map((n,i)=>e.jsxs("p",{className:"text-sm text-amber-700 flex items-start gap-2",children:[e.jsx(L,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),n]},i))}),e.jsx("div",{className:"space-y-3",children:t.days.map(n=>e.jsx($e,{day:n},n.dayNumber))}),e.jsx("div",{className:"sticky bottom-0 bg-white pt-4 pb-2 border-t border-neutral-100 -mx-6 px-6",children:e.jsx("button",{onClick:s,className:"w-full py-3 bg-accent-500 text-white rounded-lg hover:bg-accent-600 font-display font-semibold text-base transition-all duration-200 shadow-sm hover:shadow-medium active:scale-[0.98]",children:"✓ Looks Good — Create This Trip"})})]}):null},$e=({day:s})=>{const[t,a]=j.useState(!1),{selectCampsite:o}=k(),n=s.type==="driving"||s.type==="crossing",i=s.type==="rest",l=s.date instanceof Date?s.date.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}):"";return e.jsxs("div",{className:`rounded-xl overflow-hidden shadow-soft ${s.type==="crossing"?"ring-1 ring-blue-200 bg-blue-50/50":i?"ring-1 ring-green-200 bg-green-50/50":"ring-1 ring-neutral-200/50"}`,children:[e.jsxs("button",{onClick:()=>a(!t),className:"w-full text-left p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${s.type==="crossing"?"bg-blue-200 text-blue-800":i?"bg-green-200 text-green-800":"bg-neutral-200 text-neutral-800"}`,children:s.dayNumber}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-neutral-900",children:i?`Rest Day — ${s.start.name}`:`${s.start.name} → ${s.end.name}`}),s.type==="crossing"&&e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full",children:[e.jsx(_,{className:"w-3 h-3 inline mr-0.5"}),"Crossing"]})]}),e.jsxs("div",{className:"text-xs text-neutral-500 mt-0.5",children:[l,n&&` · ${s.distance} km · ${s.drivingTime} hrs driving`]})]})]}),e.jsx(K,{className:`w-5 h-5 text-neutral-400 transition-transform ${t?"rotate-90":""}`})]}),s.selectedOvernight&&!t&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 ml-11 text-xs text-neutral-500",children:[e.jsx(W,{className:"w-3.5 h-3.5 text-green-600"}),e.jsxs("span",{children:["Staying at ",e.jsx("strong",{children:s.selectedOvernight.campsite.name})]}),e.jsxs("span",{className:"text-green-600",children:["(",s.selectedOvernight.suitabilityScore,"/100)"]})]})]}),t&&e.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[s.notes.length>0&&e.jsx("div",{className:"text-xs text-neutral-500 space-y-0.5 ml-11",children:s.notes.map((r,c)=>e.jsxs("p",{className:"flex items-start gap-1",children:[e.jsx(le,{className:"w-3 h-3 mt-0.5 flex-shrink-0"})," ",r]},c))}),s.crossing&&e.jsxs("div",{className:"ml-11 bg-blue-50 rounded-lg p-3 text-sm",children:[e.jsxs("p",{className:"font-medium text-blue-900 flex items-center gap-1",children:[s.crossing.type==="tunnel"?e.jsx(Ne,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})," ",s.crossing.name]}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[s.crossing.operators.join(", ")," · ",s.crossing.duration<60?`${s.crossing.duration} min`:`${Math.floor(s.crossing.duration/60)}h ${s.crossing.duration%60>0?`${s.crossing.duration%60}m`:""}`," crossing · £",s.crossing.estimatedCost.low,"–£",s.crossing.estimatedCost.high]}),e.jsx("div",{className:"flex gap-2 mt-2",children:s.crossing.bookingUrls.map((r,c)=>e.jsxs("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 bg-white px-2 py-1 rounded border border-blue-200",children:["Book ",s.crossing.operators[c]||"Now",e.jsx(q,{className:"w-3 h-3"})]},c))})]}),s.overnightOptions.length>0&&e.jsxs("div",{className:"ml-11",children:[e.jsxs("p",{className:"text-xs font-medium text-neutral-700 mb-2",children:[e.jsx(W,{className:"w-3.5 h-3.5 inline mr-1"}),"Overnight Options (",s.overnightOptions.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.overnightOptions.map((r,c)=>{const u=s.selectedOvernight?.campsite.id===r.campsite.id;return e.jsxs("button",{onClick:()=>o(s.dayNumber,r),className:`w-full text-left p-3 rounded-xl border-2 transition-all duration-200 ${u?"border-green-500 bg-green-50 shadow-sm":"border-neutral-200 hover:border-neutral-300 hover:shadow-sm"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-sm text-neutral-900",children:[c===0&&"⭐ ",r.campsite.name]}),e.jsxs("span",{className:"text-xs text-neutral-500 ml-2",children:[r.distanceFromRoute," km from route"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("span",{className:`text-xs font-bold ${r.suitabilityScore>=80?"text-green-600":r.suitabilityScore>=60?"text-yellow-600":"text-neutral-500"}`,children:[r.suitabilityScore,"/100"]}),u&&e.jsx(T,{className:"w-4 h-4 text-green-600"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:r.amenitySummary.slice(0,5).map(d=>e.jsx("span",{className:"text-xs bg-neutral-100 text-neutral-600 px-1.5 py-0.5 rounded",children:d},d))})]},r.campsite.id)})})]})]})]})};export{Qe as default};
